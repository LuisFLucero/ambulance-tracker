{% extends "layout.html" %}

{% block content %}
<h2>Request an Ambulance</h2>

<!-- Map -->
<div id="map"></div>

<!-- Emergency request form -->
<form method="post" action="{{ url_for('client_request') }}" style="margin-top:1rem;">
  <label for="address">Address:</label><br>
  <input type="text" id="address" name="address" required><br><br>

  <label for="condition">Patient Condition:</label><br>
  <textarea id="condition" name="condition" rows="3" required></textarea><br><br>

  <!-- hidden lat/lon fields -->
  <input type="hidden" name="lat" id="lat">
  <input type="hidden" name="lon" id="lon">

  <button type="submit">Submit Request</button>
</form>

<p id="status-message"></p>
{% endblock %}

{% block scripts %}
<script>
  // fill hidden fields with current location
  if ("geolocation" in navigator) {
    navigator.geolocation.getCurrentPosition(pos => {
      document.getElementById('lat').value = pos.coords.latitude;
      document.getElementById('lon').value = pos.coords.longitude;
    });
  }
</script>
<script src="{{ url_for('static', filename='client/script.js') }}"></script>
{% endblock %}
